(()=>{var e={};e.id=627,e.ids=[627],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1017:e=>{"use strict";e.exports=require("path")},7310:e=>{"use strict";e.exports=require("url")},4151:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>d});var s=r(7096),n=r(6132),a=r(7284),i=r.n(a),o=r(2564),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let d=["",{children:["preview",{children:["[filename]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,250)),"/Users/jamesonfarmer/sdev334/centroid-finder/frontend/src/app/preview/[filename]/page.jsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,4553)),"/Users/jamesonfarmer/sdev334/centroid-finder/frontend/src/app/layout.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/jamesonfarmer/sdev334/centroid-finder/frontend/src/app/preview/[filename]/page.jsx"],p="/preview/[filename]/page",x={require:r,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/preview/[filename]/page",pathname:"/preview/[filename]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},3394:(e,t,r)=>{Promise.resolve().then(r.bind(r,8283))},8283:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>VideoChooserPage});var s,n=r(784),a=r(5570),i=r(9885),o=r(7114),l=r(9273),d=r(7799),c=r(3655),p=r(6157),x=r(6981),u=r(6061),h=r(1133),m=r(4349),f=r(2618);function CompletedJobs({jobs:e}){return e.length?(0,n.jsxs)(d.Z,{sx:{marginTop:6},children:[n.jsx(c.Z,{variant:"h6",children:"Completed Jobs"}),n.jsx(h.Z,{children:e.map(({jobId:e,filename:t})=>(0,n.jsxs)(m.ZP,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx(c.Z,{children:"Video: "+t+"  -  Job ID: "+e}),n.jsx(f.Z,{href:`http://localhost:3000/process/${t.slice(0,t.length-4)}_${e}.csv`,download:`${t.replace(/\.[^/.]+$/,"")}.csv`,sx:{textDecoration:"none"},children:n.jsx(x.Z,{variant:"outlined",size:"small",children:"Download"})})]},e))})]}):null}var g=r(8256);let j=(s=({filename:e,color:t,threshold:r,status:s,error:a,jobId:o,start:l})=>{let[p,h]=(0,i.useState)([]);return(0,i.useEffect)(()=>{if(!o)return;let t=setInterval(async()=>{try{let r=await fetch(`http://localhost:3000/process/${o}/status`),s=await r.json();"done"===s.status&&(h(t=>[...t,{jobId:o,filename:e}]),clearInterval(t))}catch(e){console.error("Failed to check job status:",e),clearInterval(t)}},2e3);return()=>clearInterval(t)},[o,e]),(0,n.jsxs)(d.Z,{sx:{marginTop:6,textAlign:"center"},children:[n.jsx(x.Z,{variant:"contained",onClick:()=>l(e,t,r),disabled:"processing"===s,sx:{backgroundColor:"lightblue",color:"black"},children:"processing"===s?"Processing...":"Start Process"}),"processing"===s&&n.jsx(d.Z,{sx:{width:"100%",mt:2},children:n.jsx(u.Z,{})}),a&&n.jsx(c.Z,{sx:{mt:2,color:"red"},children:a}),"done"===s&&n.jsx(d.Z,{sx:{mt:2},children:n.jsx(c.Z,{children:"âœ… Process complete!"})}),n.jsx(CompletedJobs,{jobs:p})]})},function(e){let[t,r]=(0,i.useState)("idle"),[a,o]=(0,i.useState)(""),[l,d]=(0,i.useState)(null),start=async(e,t,s)=>{o(""),r("processing");try{let r=await fetch(`http://localhost:3000/process/${e}?targetColor=${t.slice(1)}&threshold=${s}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!r.ok){let{error:e}=await r.json();throw Error(e)}let n=await r.json();d(n.jobId)}catch(e){o(e.message),r("idle")}};return(0,n.jsxs)(n.Fragment,{children:[a&&n.jsx(g.Z,{severity:"error",sx:{mb:2},children:a}),n.jsx(s,{...e,status:t,error:a,jobId:l,start:start})]})});function PreviewVideo({params:e}){let{filename:t}=(0,o.useParams)(),[r,s]=(0,i.useState)("#000000"),[a,x]=(0,i.useState)(100),u=(0,i.useRef)(null),h=(0,i.useRef)(null),m=`http://localhost:3000/thumbnail/${encodeURIComponent(t)}`;(0,i.useEffect)(()=>{let e=new Image;e.crossOrigin="Anonymous",e.src=m,e.onload=()=>{h.current=e,drawBinarized(e,r,a)}},[m]),(0,i.useEffect)(()=>{h.current&&drawBinarized(h.current,r,a)},[r,a]);let drawBinarized=(e,t,r)=>{let s=u.current,n=s.getContext("2d"),a=300/e.width,i=e.width*a,o=e.height*a;s.width=i,s.height=o,n.drawImage(e,0,0,i,o);let l=n.getImageData(0,0,i,o),d=l.data,c=parseInt(t.slice(1,3),16),p=parseInt(t.slice(3,5),16),x=parseInt(t.slice(5,7),16);for(let e=0;e<d.length;e+=4){let t=d[e],s=d[e+1],n=d[e+2],a=Math.sqrt((t-c)**2+(s-p)**2+(n-x)**2),i=a<r?0:255;d[e]=d[e+1]=d[e+2]=i}n.putImageData(l,0,0)},f={padding:2,borderRadius:2,backgroundColor:"#fff",boxShadow:1,textAlign:"center",maxWidth:320,flex:"1 1 320px"};return(0,n.jsxs)(l.Z,{maxWidth:"md",sx:{py:5,px:3,bgcolor:"#f9f9f9",borderRadius:2,boxShadow:2,marginTop:2},children:[(0,n.jsxs)(d.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:5,marginBottom:2},children:[(0,n.jsxs)(c.Z,{variant:"h4",sx:{fontWeight:600,color:"#1976d2"},children:["Preview: ",t]}),(0,n.jsxs)(d.Z,{sx:{display:"flex",gap:4,flexWrap:"wrap",justifyContent:"center",width:"100%"},children:[(0,n.jsxs)(d.Z,{sx:f,children:[n.jsx(c.Z,{variant:"h6",gutterBottom:!0,children:"Original"}),n.jsx("img",{src:m,alt:"Original thumbnail",style:{width:"300px",borderRadius:8,border:"1px solid #ccc"}})]}),(0,n.jsxs)(d.Z,{sx:f,children:[n.jsx(c.Z,{variant:"h6",gutterBottom:!0,children:"Binarized"}),n.jsx("canvas",{ref:u,style:{width:"300px",borderRadius:8,border:"1px solid #ccc"}})]})]}),(0,n.jsxs)(d.Z,{sx:{display:"flex",alignItems:"center",flexWrap:"wrap",gap:2,padding:3,borderRadius:2,backgroundColor:"#fff",boxShadow:1,justifyContent:"center"},children:[n.jsx(c.Z,{children:"Pick Target Color:"}),n.jsx("input",{type:"color",value:r,onChange:e=>s(e.target.value),style:{width:40,height:40,border:"none",borderRadius:4,cursor:"pointer"}}),n.jsx(c.Z,{sx:{marginLeft:2},children:"Threshold:"}),n.jsx(p.ZP,{value:a,min:0,max:255,onChange:(e,t)=>x(t),sx:{width:250}})]})]}),n.jsx(j,{filename:t,color:r,threshold:a})]})}function VideoChooserPage(){return(0,n.jsxs)(n.Fragment,{children:[n.jsx(a.Z,{}),n.jsx(PreviewVideo,{})]})}},250:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>i,__esModule:()=>a,default:()=>l});var s=r(5153);let n=(0,s.createProxy)(String.raw`/Users/jamesonfarmer/sdev334/centroid-finder/frontend/src/app/preview/[filename]/page.jsx`),{__esModule:a,$$typeof:i}=n,o=n.default,l=o}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[264,620,432,359,152,773],()=>__webpack_exec__(4151));module.exports=r})();